# Internal monitoring dashboard
server {
    listen 80;
    server_name dashboard.example.local;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name dashboard.example.local;

    ssl_certificate /etc/nginx/ssl/wildcard_chain.crt;
    ssl_certificate_key /etc/nginx/ssl/wildcard.example.local.key;

    root /var/www/dashboard;
    index index.html;

    # Restrict access to internal network
    allow 192.168.204.0/24;
    deny all;

    access_log /var/log/nginx/dashboard.access.log main;
    error_log /var/log/nginx/dashboard.error.log;

    location / {
        try_files $uri $uri/ =404;
    }

    location /api/status {
        add_header Content-Type application/json;
        return 200 '{"status":"ok","timestamp":"$time_iso8601","server":"$hostname"}';
    }

    location /nginx_status {
        stub_status on;
        access_log off;
    }
}